-- Horse Race GUI Script (4 at + final duel)
local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Chat'e mesaj gÃ¶nderme
local function send(msg)
	local channel = TextChatService.TextChannels.RBXGeneral
	channel:SendAsync(msg)
end

-- BaÅŸlangÄ±Ã§ at listesi (4 at)
local STARTING_HORSES = {"ğŸ´1","ğŸ´2","ğŸ´3",}
local TRACK_LENGTH = 10 -- pist uzunluÄŸu
local FRAME_DELAY = 5   -- frame gecikmesi
local running = false

-- KarÄ±ÅŸtÄ±rma fonksiyonu
local function shuffle(t)
	for i = #t, 2, -1 do
		local j = math.random(i)
		t[i], t[j] = t[j], t[i]
	end
end

-- YarÄ±ÅŸÄ± baÅŸlat
local function startRace()
	if running then return end
	running = true

	local HORSES = table.clone(STARTING_HORSES)
	local length = TRACK_LENGTH
	local finalDuel = false
	local finalRounds = 0

	send("ğŸğŸHorseracing starts...ğŸğŸš©")

	while running and #HORSES > 1 and length > 0 do
		task.wait(FRAME_DELAY)

		-- AtlarÄ± karÄ±ÅŸtÄ±r
		shuffle(HORSES)

		-- Pist Ã§iz (atlar aralÄ±klÄ±)
		local line = table.concat(HORSES, " ")
		local track = string.rep("Â·", length)
		send(line .. " " .. track .. "ğŸš©")

		length -= 1

		-- Son 2 at kalÄ±nca Final Duel baÅŸlat
		if #HORSES == 2 then
			if not finalDuel then
				finalDuel = true
				finalRounds = 0
				send("ğŸ”¥Final DuelğŸ”¥")
			end

			finalRounds += 1
			if finalRounds < 3 then
				continue
			end
		end

		-- EÄŸer final duel bitmediyse eleme yap
		if #HORSES > 1 then
			table.remove(HORSES)
		end
	end

	-- Kazanan tek kalan at
	if #HORSES == 1 then
		send("ğŸ† " .. HORSES[1] .. " WINS THE RACE!!! ğŸ†")
	end

	running = false
end

-- GUI oluÅŸtur
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "HorseRaceGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 160, 0, 55)
button.Position = UDim2.new(1, -180, 1, -80) -- saÄŸ alt kÃ¶ÅŸe
button.BackgroundColor3 = Color3.fromRGB(255, 215, 0) -- altÄ±n renk
button.Text = "ğŸ‡ Start Race"
button.TextScaled = true
button.Font = Enum.Font.FredokaOne
button.TextColor3 = Color3.fromRGB(0,0,0)
button.Parent = screenGui
button.BorderSizePixel = 0

-- Buton tÄ±klandÄ±ÄŸÄ±nda yarÄ±ÅŸÄ± baÅŸlat
button.MouseButton1Click:Connect(function()
	if not running then
		startRace()
	end
end)
